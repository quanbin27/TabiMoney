@startuml SEQ_002_Login
actor User
participant "Frontend" as Frontend
participant "Backend API" as Backend
participant "Auth Service" as Auth
participant "Database" as DB
participant "JWT Service" as JWT

User -> Frontend: Nhập email/password
Frontend -> Backend: POST /api/v1/auth/login
Backend -> Auth: Login(request)
Auth -> DB: SELECT user WHERE email
DB --> Auth: User data
Auth -> Auth: Verify password
alt Mật khẩu sai
    Auth --> Backend: Error
    Backend --> Frontend: 401 Unauthorized
    Frontend --> User: Sai mật khẩu
else Mật khẩu đúng
    Auth -> DB: UPDATE last_login_at
    Auth -> JWT: Generate tokens
    JWT --> Auth: Tokens
    Auth -> DB: INSERT INTO user_sessions
    Auth --> Backend: AuthResponse
    Backend --> Frontend: 200 OK
    Frontend --> User: Đăng nhập thành công
end

@enduml

