@startuml ACT_020_DetailedReport
start
:User truy cập trang "Báo cáo" hoặc "Phân tích";
:User chọn khoảng thời gian:
tháng này, quý này, năm này, hoặc custom range;
:Query database với filters:
start_date, end_date, user_id;
if (Không có dữ liệu trong khoảng thời gian?) then (có)
  :Trả về report với tất cả giá trị = 0;
  :Hiển thị "Không có dữ liệu trong khoảng thời gian này";
  stop
endif
:Tính toán các chỉ số:
- Total income, total expense, net savings
- Spending by category (với biểu đồ)
- Spending trends (daily/weekly/monthly)
- Top 5 categories chi tiêu nhiều nhất
- So sánh với kỳ trước (nếu có)
- Average transaction amount
- Number of transactions;
:Tạo biểu đồ data:
- Pie chart: Spending by category
- Line chart: Spending trends
- Bar chart: Comparison với kỳ trước;
:Trả về report data;
:Frontend hiển thị báo cáo với các biểu đồ;
if (User muốn export?) then (có)
  :Tạo file PDF/Excel;
  :Download file;
endif
stop
@enduml

