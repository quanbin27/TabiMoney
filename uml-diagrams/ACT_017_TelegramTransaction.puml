@startuml ACT_017_TelegramTransaction
start
:User mở Telegram Bot;
:User gửi tin nhắn: "ăn bún bò 50k";
:Bot nhận diện telegram_user_id;
:Tìm web_user_id từ telegram_accounts;
if (Không tìm thấy web_user_id?) then (có)
  :Bot thông báo "Bạn chưa liên kết tài khoản";
  :Hướng dẫn dùng /link để liên kết;
  stop
endif
:Bot gửi request đến Backend API
với web_user_id và message;
:Backend gọi AI Service để xử lý NLU;
:AI Service trích xuất:
amount, category, description;
if (AI không hiểu?) then (có)
  :Bot yêu cầu user nhập lại;
  :Hướng dẫn format: "/add [số tiền] [mô tả]";
  stop
endif
:Backend tạo transaction;
:Backend trả về transaction đã tạo;
:Bot format và gửi xác nhận:
"✅ Đã thêm: Ăn uống - 50,000 VND";
:User thấy xác nhận trong Telegram;
stop
@enduml

