@startuml Sequence_AnomalyDetection
actor User
participant "Frontend" as Frontend
participant "Backend API" as Backend
participant "Analytics Handler" as Analytics
participant "AI Service" as AI
participant "Anomaly Service" as Anomaly
participant "Database" as DB
participant "Notification Service" as Notification

User -> Frontend: Xem phân tích bất thường
Frontend -> Backend: GET /api/v1/analytics/anomalies
Backend -> Analytics: GetAnomalies(userID)
Analytics -> DB: Lấy lịch sử giao dịch
DB --> Analytics: Transaction history
Analytics -> AI: POST /api/v1/ai/anomaly/detect
AI -> Anomaly: Phân tích pattern
Anomaly -> Anomaly: Tính toán statistical model
Anomaly -> Anomaly: So sánh với baseline
Anomaly --> AI: Danh sách anomalies
AI --> Analytics: Anomaly results
Analytics -> Notification: Kiểm tra cần gửi cảnh báo?
alt Có bất thường nghiêm trọng
    Notification -> DB: Tạo notification
    Notification --> User: Gửi thông báo
end
Analytics --> Backend: Anomaly list
Backend --> Frontend: Anomalies response
Frontend --> User: Hiển thị bất thường

@enduml

