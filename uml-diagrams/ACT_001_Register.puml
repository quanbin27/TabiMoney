@startuml ACT_001_Register
start
:User truy cập trang đăng ký;
:User nhập thông tin:
email, username, password,
first_name, last_name;
:Validate dữ liệu đầu vào;
if (Dữ liệu hợp lệ?) then (không)
  :Hiển thị lỗi validation;
  stop
endif
:Kiểm tra email hoặc username đã tồn tại?;
if (Email hoặc username đã tồn tại?) then (có)
  :Trả về lỗi "user with this email or username already exists";
  stop
endif
:Hash password bằng bcrypt;
:Tạo user record trong database;
:Tạo user_profile mặc định;
:Generate JWT access token và refresh token;
:Tạo user session;
:Cập nhật last_login_at;
:Trả về AuthResponse với tokens;
:Chuyển đến trang đăng nhập;
stop
@enduml

